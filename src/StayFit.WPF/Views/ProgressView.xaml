<Page x:Class="StayFit.WPF.Views.ProgressView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
      Title="ProgressView"
      Background="{DynamicResource MaterialDesignPaper}">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <Grid Margin="24">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!-- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº -->
            <StackPanel Grid.Row="0" Margin="0,0,0,20">
                <TextBlock Text="ðŸ“ˆ ÐŸÑ€Ð¾Ð³Ñ€ÐµÑ Ð²Ð°Ð³Ð¸"
                           FontSize="28"
                           FontWeight="Bold"
                           Foreground="{DynamicResource PrimaryHueMidBrush}" />
                <TextBlock Text="Ð’Ñ–Ð´ÑÑ‚ÐµÐ¶ÑƒÐ¹Ñ‚Ðµ ÑÐ²Ð¾ÑŽ Ð²Ð°Ð³Ñƒ Ñ‚Ð° Ð´Ð¾ÑÑÐ³Ð°Ð¹Ñ‚Ðµ Ñ†Ñ–Ð»ÐµÐ¹"
                           FontSize="14"
                           Foreground="Gray"
                           Margin="0,5,0,0" />
            </StackPanel>

            <!-- Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° -->
            <UniformGrid Grid.Row="1" Columns="4" Margin="0,0,0,20">
                <materialDesign:Card Padding="15" Margin="5">
                    <StackPanel>
                        <TextBlock Text="ðŸ‹ï¸ ÐŸÐ¾Ñ‚Ð¾Ñ‡Ð½Ð°" Foreground="Gray" FontSize="12" />
                        <TextBlock Text="{Binding CurrentWeight, StringFormat={}{0:F1}}"
                                   FontSize="32"
                                   FontWeight="Bold"
                                   Foreground="{DynamicResource PrimaryHueMidBrush}" />
                        <TextBlock Text="ÐºÐ³"
                                   Foreground="Gray"
                                   FontSize="12"
                                   Margin="0,-5,0,0" />
                    </StackPanel>
                </materialDesign:Card>

                <materialDesign:Card Padding="15" Margin="5">
                    <StackPanel>
                        <TextBlock Text="ðŸš© ÐŸÐ¾Ñ‡Ð°Ñ‚ÐºÐ¾Ð²Ð°" Foreground="Gray" FontSize="12" />
                        <TextBlock Text="{Binding StartWeight, StringFormat={}{0:F1}}"
                                   FontSize="32"
                                   FontWeight="Bold" />
                        <TextBlock Text="ÐºÐ³"
                                   Foreground="Gray"
                                   FontSize="12"
                                   Margin="0,-5,0,0" />
                    </StackPanel>
                </materialDesign:Card>

                <materialDesign:Card Padding="15" Margin="5">
                    <StackPanel>
                        <TextBlock Text="ðŸ“‰ Ð—Ð¼Ñ–Ð½Ð°" Foreground="Gray" FontSize="12" />
                        <TextBlock Text="{Binding WeightChangeText}"
                                   FontSize="28"
                                   FontWeight="Bold"
                                   Foreground="#4CAF50" />
                    </StackPanel>
                </materialDesign:Card>

                <materialDesign:Card Padding="15" Margin="5">
                    <StackPanel>
                        <TextBlock Text="ðŸŽ¯ Ð”Ð¾ Ñ†Ñ–Ð»Ñ–" Foreground="Gray" FontSize="12" />
                        <TextBlock Text="{Binding RemainingWeight, StringFormat={}{0:F1}}"
                                   FontSize="32"
                                   FontWeight="Bold"
                                   Foreground="#E91E63" />
                        <TextBlock Text="ÐºÐ³ Ð·Ð°Ð»Ð¸ÑˆÐ¸Ð»Ð¾ÑÑŒ"
                                   Foreground="Gray"
                                   FontSize="12"
                                   Margin="0,-5,0,0" />
                    </StackPanel>
                </materialDesign:Card>
            </UniformGrid>

            <!-- Ð¤Ð¾Ñ€Ð¼Ð° Ð´Ð¾Ð´Ð°Ð²Ð°Ð½Ð½Ñ -->
            <materialDesign:Card Grid.Row="2" Padding="20" Margin="0,0,0,20">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="150" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="100" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0"
                               Text="ðŸ“… Ð”Ð°Ñ‚Ð°:"
                               VerticalAlignment="Center"
                               FontWeight="Medium"
                               Margin="0,0,10,0" />

                    <DatePicker Grid.Column="1"
                                SelectedDate="{Binding SelectedDate}"
                                Margin="0,0,20,0"
                                VerticalAlignment="Center" />

                    <TextBlock Grid.Column="2"
                               Text="âš–ï¸ Ð’Ð°Ð³Ð° (ÐºÐ³):"
                               VerticalAlignment="Center"
                               FontWeight="Medium"
                               Margin="0,0,10,0" />

                    <TextBox Grid.Column="3"
                             Text="{Binding NewWeight, UpdateSourceTrigger=PropertyChanged}"
                             Margin="0,0,20,0"
                             VerticalAlignment="Center"
                             Padding="8,6" />

                    <Button Grid.Column="4"
                            Command="{Binding AddWeightCommand}"
                            Background="#4CAF50"
                            Foreground="White"
                            Padding="20,8"
                            FontWeight="Bold">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="âž•" Margin="0,0,8,0" />
                            <TextBlock Text="Ð”ÐžÐ”ÐÐ¢Ð˜" />
                        </StackPanel>
                    </Button>

                    <!-- ÐŸÑ€Ð¾Ð³Ñ€ÐµÑ Ð±Ð°Ñ€ -->
                    <StackPanel Grid.Column="5"
                                VerticalAlignment="Center"
                                Margin="30,0,0,0">
                        <TextBlock Text="{Binding ProgressPercentage, Mode=OneWay, StringFormat='ÐŸÑ€Ð¾Ð³Ñ€ÐµÑ Ð´Ð¾ Ñ†Ñ–Ð»Ñ–: {0:F0}%'}"
                                   FontSize="12"
                                   Foreground="Gray"
                                   Margin="0,0,0,5" />
                        <ProgressBar Value="{Binding ProgressPercentage, Mode=OneWay}"
                                     Maximum="100"
                                     Height="10"
                                     Foreground="#4CAF50" />
                    </StackPanel>
                </Grid>
            </materialDesign:Card>

            <!-- Ð’Ñ–Ð·ÑƒÐ°Ð»ÑŒÐ½Ð¸Ð¹ Ð³Ñ€Ð°Ñ„Ñ–Ðº (Ð¿Ñ€Ð¾ÑÑ‚Ð¸Ð¹ Ñ‡ÐµÑ€ÐµÐ· ItemsControl) -->
            <materialDesign:Card Grid.Row="3" Padding="20" Margin="0,0,0,20">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="150" />
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0"
                               Text="ðŸ“Š Ð“Ñ€Ð°Ñ„Ñ–Ðº Ð²Ð°Ð³Ð¸"
                               FontSize="18"
                               FontWeight="Bold"
                               Margin="0,0,0,15" />

                    <ItemsControl Grid.Row="1" ItemsSource="{Binding WeightHistory}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel Orientation="Horizontal" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Grid Margin="2,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <!-- Ð¡Ñ‚Ð¾Ð²Ð¿Ñ‡Ð¸Ðº -->
                                    <Border Grid.Row="0"
                                            Background="{DynamicResource PrimaryHueMidBrush}"
                                            CornerRadius="4,4,0,0"
                                            VerticalAlignment="Bottom"
                                            Height="{Binding BarHeight}" />

                                    <!-- Ð’Ð°Ð³Ð° -->
                                    <TextBlock Grid.Row="1"
                                               Text="{Binding Weight, StringFormat={}{0:F1}}"
                                               HorizontalAlignment="Center"
                                               FontWeight="Bold"
                                               FontSize="11"
                                               Foreground="{DynamicResource PrimaryHueMidBrush}"
                                               Margin="0,5,0,0" />

                                    <!-- Ð”Ð°Ñ‚Ð° -->
                                    <TextBlock Grid.Row="2"
                                               Text="{Binding ShortDate}"
                                               HorizontalAlignment="Center"
                                               FontSize="10"
                                               Foreground="Gray" />
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </Grid>
            </materialDesign:Card>

            <!-- Ð†ÑÑ‚Ð¾Ñ€Ñ–Ñ -->
            <materialDesign:Card Grid.Row="4" Padding="20">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,15">
                        <TextBlock Text="ðŸ“‹ Ð†ÑÑ‚Ð¾Ñ€Ñ–Ñ Ð²Ð¸Ð¼Ñ–Ñ€ÑŽÐ²Ð°Ð½ÑŒ" FontSize="18" FontWeight="Bold" />
                        <TextBlock Text="{Binding WeightHistory.Count, StringFormat=' ({0} Ð·Ð°Ð¿Ð¸ÑÑ–Ð²)'}"
                                   FontSize="14"
                                   Foreground="Gray"
                                   VerticalAlignment="Center" />
                    </StackPanel>

                    <ListBox Grid.Row="1"
                             ItemsSource="{Binding WeightHistory}"
                             BorderThickness="0"
                             Background="Transparent"
                             MaxHeight="300">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border BorderBrush="#E0E0E0" BorderThickness="0,0,0,1" Padding="10,12">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="150" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>

                                        <TextBlock Grid.Column="0"
                                                   Text="{Binding DateFormatted}"
                                                   VerticalAlignment="Center"
                                                   Foreground="Gray" />

                                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                                            <TextBlock Text="{Binding Weight, StringFormat={}{0:F1}}"
                                                       FontSize="20"
                                                       FontWeight="Bold"
                                                       Foreground="{DynamicResource PrimaryHueMidBrush}"
                                                       VerticalAlignment="Center" />
                                            <TextBlock Text=" ÐºÐ³"
                                                       FontSize="14"
                                                       Foreground="Gray"
                                                       VerticalAlignment="Center" />
                                        </StackPanel>

                                        <Button Grid.Column="2"
                                                Command="{Binding DataContext.DeleteWeightCommand, RelativeSource={RelativeSource AncestorType=ListBox}}"
                                                CommandParameter="{Binding}"
                                                Background="Transparent"
                                                BorderThickness="0"
                                                Foreground="#F44336"
                                                Padding="8"
                                                ToolTip="Ð’Ð¸Ð´Ð°Ð»Ð¸Ñ‚Ð¸">
                                            <TextBlock Text="ðŸ—‘ï¸" FontSize="16" />
                                        </Button>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Grid>
            </materialDesign:Card>
        </Grid>
    </ScrollViewer>
</Page>